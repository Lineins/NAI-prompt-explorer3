# NAI Prompt Explorer

## 概要
NAI Prompt Explorer は、PNG 画像に埋め込まれたプロンプト情報を高速に検索・閲覧できる Windows 向けのデスクトップアプリケーションです。大量の画像が保存されたフォルダを対象に、タグの完全一致検索や AND 検索を行い、ヒットした画像のサムネイルとプロンプトを効率的に確認できます。

## 主な機能
- **フォルダ管理**: 既定の対象フォルダやプリセットを設定し、複数のフォルダをワンクリックで切り替え。
- **検索モード**:
  - 完全一致モード: 入力文字列を順序・カンマ込みで完全一致検索。
  - AND 検索モード: カンマ区切りで入力したタグをすべて含む画像を抽出。
- **高速サムネイル表示**: 仮想化されたラップパネルで 1 万枚規模の画像も軽快に表示。サムネイルサイズはスライダーまたは Ctrl + マウスホイールで調整可能。
- **プロンプト表示**: 一覧から画像をクリックするとプロンプト全文を表示。必要に応じて `.txt` 形式で同名保存。
- **リアルタイム更新**: 監視対象フォルダに PNG が追加・削除された場合、自動で一覧へ反映。

## 動作環境
- Windows 11 (64bit)
- .NET 8 SDK 以降
- PNG 内にテキストチャンクとしてプロンプト情報が埋め込まれていること

## セットアップ手順
1. [.NET 8 SDK](https://dotnet.microsoft.com/) をインストールします。
2. 本リポジトリを任意の場所へクローンまたはダウンロードします。
3. Visual Studio 2022 以降で `NAIPromptExplorer.sln` を開くか、以下のコマンドでビルドします。
   ```powershell
   dotnet restore
   dotnet build
   ```
4. 実行する場合は `PromptExplorer` プロジェクトをスタートアップに設定し、F5 または以下のコマンドを使用します。
   ```powershell
   dotnet run --project src/PromptExplorer/PromptExplorer.csproj
   ```

## 使い方
1. 起動すると既定フォルダ (初期値: `C:\Users\kuron\Downloads\NAIv4.5画風`) が読み込まれます。
2. 検索欄にキーワードまたはタグを入力し、`検索` ボタンで絞り込みます。`AND検索モード` ボタンをクリックするとモードを切り替えられます。
3. フォルダ欄のドロップダウンからプリセットを選択するか、`参照` ボタンで新しいフォルダを追加します。`プリセット追加`、`既定に設定` ボタンで設定を更新できます。
4. サムネイル一覧から画像をクリックすると下部にプロンプトが表示されます。`プロンプトを.txtで保存` ボタンで同名のテキストファイルを出力します。
5. サムネイルサイズはスライダー、または一覧上で Ctrl + マウスホイール操作で調整できます。

## 設定ファイル
アプリ設定は `AppData\Roaming\NAIPromptExplorer\settings.json` に保存されます。内容には以下が含まれます。
- `DefaultFolder`: 既定フォルダのパス
- `LastUsedFolder`: 最後に使用したフォルダ
- `PresetFolders`: プリセットとして登録されたフォルダの一覧

設定ファイルを直接編集する場合はアプリ終了後に行ってください。

## 注意事項
- 対象フォルダには PNG ファイル以外を置かないでください。監視対象外のファイルは無視されます。
- 大量のファイルを初めて読み込む際は解析に時間がかかる場合があります。処理中も UI は応答し続けます。
- プロンプト情報が PNG に含まれていない場合、検索対象にはなりません。

以上でセットアップと利用方法は完了です。快適なプロンプト探索にご活用ください。
